{
    "configuration": {
        "name": "Unrestricted Access to Port 80 (HTTP)",
        "description": "Checks for unrestricted access to HTTP Port",
        "service": "EC2",
        "resourceType": "ec2-securitygroup",
        "severity": "LOW",
        "enabled": true,
        "provider": "aws",
        "categories": [
            "security"
        ],
        "remediationNotes": "Check if resource exists",
        "attributes": [
            {
                "name": "port80ipRanges",
                "path": "data.IpPermissions[?(@.FromPort<='80' && @.ToPort>='80')].IpRanges[*].CidrIp",
                "required": true
            }
        ],
        "rules": [
            {
                "conditions": {
                    "all": [
                        {
                            "fact": "port80ipRanges",
                            "operator": "notEqual",
                            "value": "0.0.0.0/0"
                        }
                    ]
                },
                "event": {
                    "type": "Unrestricted access to port 80"
                }
            }
        ]
    },
    "resource": {
        "accountId": "ed3b1234-1234-1234-1234-12349255f1ae",
        "organisationId": "1234567",
        "resourceId": "sg-162837",
        "service": "EC2",
        "ccrn": "ccrn:aws:ed3b1234-1234-1234-1234-12349255f1ae:EC2:ap-southeast-2:sg-162837",
        "region": "ap-southeast-2",
        "descriptorType": "ec2-securitygroup",
        "data": {
            "Description": "This security group was generated by AWS Marketplace and is based on recommended settings for Amazon Linux 2 AMI with Amazon Inspector Agent version 1.0 provided by Amazon Web Services",
            "GroupName": "Amazon Linux 2 AMI with Amazon Inspector Agent-1-0-AutogenByAWSMP-",
            "IpPermissions": [
                {
                    "FromPort": 80,
                    "IpProtocol": "tcp",
                    "IpRanges": [
                        {
                            "CidrIp": "0.0.0.0/0"
                        }
                    ],
                    "Ipv6Ranges": [],
                    "PrefixListIds": [],
                    "ToPort": 80,
                    "UserIdGroupPairs": []
                },
                {
                    "FromPort": 22,
                    "IpProtocol": "tcp",
                    "IpRanges": [
                        {
                            "CidrIp": "0.0.0.0/0"
                        }
                    ],
                    "Ipv6Ranges": [],
                    "PrefixListIds": [],
                    "ToPort": 22,
                    "UserIdGroupPairs": []
                },
                {
                    "FromPort": 130,
                    "IpProtocol": "tcp",
                    "IpRanges": [
                        {
                            "CidrIp": "0.0.0.0/0"
                        }
                    ],
                    "Ipv6Ranges": [],
                    "PrefixListIds": [],
                    "ToPort": 140,
                    "UserIdGroupPairs": []
                }
            ],
            "OwnerId": "115637824961",
            "GroupId": "sg-162837",
            "IpPermissionsEgress": [
                {
                    "IpProtocol": "-1",
                    "IpRanges": [
                        {
                            "CidrIp": "0.0.0.0/0"
                        }
                    ],
                    "Ipv6Ranges": [],
                    "PrefixListIds": [],
                    "UserIdGroupPairs": []
                }
            ],
            "Tags": [],
            "VpcId": "vpc-12345",
            "resourceId": "sg-162837"
        },
        "name": "EC2 Security Group",
        "link": "https://ap-southeast-2.console.aws.amazon.com/ec2/v2/home?region=ap-southeast-2#SecurityGroup:groupId=sg-162837",
        "linkTitle": "sg-162837",
        "errors": null,
        "provider": "aws",
        "lastModifiedDate": 1650986740020,
        "lastModifiedBy": "SYSTEM"
    }
}
